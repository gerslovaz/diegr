# Plot interactive waveform graph

Function for plotting time series of EEG signal colour-coded by epoch,
condition, channel, subject or group (depending on selected `level`
parameter) an interactive `plotly` graph. The function assumes that the
input data have already been filtered to the desired subset according to
the `level`. When using the function for plotting the average, there is
an option to add a confidence band using the `CI` argument. The output
in [plotly](https://rdrr.io/pkg/plotly/man/plotly.html) format enables
to easily edit the image layout.

## Usage

``` r
interactive_waveforms(
  data,
  amplitude = "signal",
  FS = 250,
  t0 = NULL,
  col_palette,
  level = "epoch",
  avg = TRUE,
  CI = FALSE,
  use_latex = TRUE
)
```

## Arguments

- data:

  A data frame, tibble or a database table with input data containing a
  `time` column and columns corresponding to the selected `amplitude`
  and `level` parameter (see Details).

- amplitude:

  A character specifying the name of the column from input data with an
  EEG amplitude values. Default is `"signal"`.

- FS:

  The sampling frequency. Default value is 250 Hz.

- t0:

  Index of the zero time point, i.e. point, where 0 ms should be marked
  (most often time of the stimulus or time of the response).

- col_palette:

  Optionally, a colour palette for plotting lines. If missing, the
  rainbow palette is used. The expected length is the same (or higher)
  as the number of unique levels (e.g. number of epochs for
  `level = "epoch"`).

- level:

  A character specifying the level of the time curves. The possible
  values are `"epoch"` (default option), `"condition"`, `"sensor"`,
  `"subject"` and `"group"`. See details for more information.

- avg:

  A logical value indicating, if the average black curve should be
  plotted. Default is `TRUE`.

- CI:

  A logical value indicating, if the confidence ribbon should be
  plotted. Default is `FALSE`. See Details for more information.

- use_latex:

  A logical value indicating whether to use LaTeX formatting for the
  y-axis title. The default is `TRUE`.

## Value

A `plotly` object showing an interactive time series of the signal
according to the chosen level.

## Details

The input data frame or database table must contain column `time` (a
column with time point numbers) and a column with the EEG amplitude (or
average amplitude) specified in the argument `amplitude`.  
It must also contain at least one of the optional columns (according to
the `level` parameter - for `"sensor"` level the column `sensor` is
required etc.):  
`group` - a column with group identifiers,  
`subject` - a column with subject IDs,  
`sensor` - a column with sensor labels,  
`epoch` - a column with epoch numbers.

Note: The average signals must be pre-aggregated before plotting at
higher grouping levels, for example `sensor` level assumes a mean sensor
signal in the `amplitude` column (the input data for individual epochs
together with sensor level setting will result in a mess output).

Plotting confidence ribbon: To plot the confidence bands around the
average lines (`CI = TRUE`), the input data must include the `ci_up` and
`ci_low` columns (as in the output tibble from
[`compute_mean`](https://gerslovaz.github.io/diegr/reference/compute_mean.md)
function).

## Examples

``` r
# 1) Plot epoch waveforms with average curve for subject 1 and electrode "E65"
# with 250 sampling frequency rate (default) and 10 as zero time point
epochdata |>
pick_data(subject_rg = 1, sensor_rg = "E65") |>
interactive_waveforms(amplitude = "signal", t0 = 10, level = "epoch")

{"x":{"visdat":{"2969129f0809":["function () ","plotlyVisDat"],"29697cd1a17c":["function () ","data"],"29694b304197":["function () ","data"],"29694a1334c8":["function () ","data"],"29691332f550":["function () ","data"],"2969186a0595":["function () ","data"],"296968249076":["function () ","data"],"296926f3dd1a":["function () ","data"],"2969791c94b8":["function () ","data"],"296966ea44f":["function () ","data"],"296924d2c875":["function () ","data"],"296967223b61":["function () ","data"],"296947f4167b":["function () ","data"],"296961433e61":["function () ","data"],"29694f07dbe9":["function () ","data"],"29695b1cfcf7":["function () ","data"]},"cur_data":"29695b1cfcf7","attrs":{"29697cd1a17c":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines","line":{"color":"#FF0000"},"name":"1","inherit":true},"29694b304197":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines","line":{"color":"#FF6D00"},"name":"2","inherit":true},"29694a1334c8":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines","line":{"color":"#FFDB00"},"name":"3","inherit":true},"29691332f550":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines","line":{"color":"#B6FF00"},"name":"4","inherit":true},"2969186a0595":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines","line":{"color":"#49FF00"},"name":"5","inherit":true},"296968249076":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines","line":{"color":"#00FF24"},"name":"6","inherit":true},"296926f3dd1a":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines","line":{"color":"#00FF92"},"name":"7","inherit":true},"2969791c94b8":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines","line":{"color":"#00FFFF"},"name":"8","inherit":true},"296966ea44f":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines","line":{"color":"#0092FF"},"name":"9","inherit":true},"296924d2c875":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines","line":{"color":"#0024FF"},"name":"10","inherit":true},"296967223b61":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines","line":{"color":"#4900FF"},"name":"11","inherit":true},"296947f4167b":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines","line":{"color":"#B600FF"},"name":"12","inherit":true},"296961433e61":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines","line":{"color":"#FF00DB"},"name":"13","inherit":true},"29694f07dbe9":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines","line":{"color":"#FF006D"},"name":"14","inherit":true},"29695b1cfcf7":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines","line":{"color":"black"},"name":"Average","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"Time (ms)"},"yaxis":{"domain":[0,1],"automargin":true,"title":"$\\mu V$"},"showlegend":false,"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[-36,-32,-28,-24,-20,-16,-12,-8,-4,0,4,8,12,16,20,24,28,32,36,40,44,48,52,56,60,64,68,72,76,80,84,88,92,96,100,104,108,112,116,120,124,128,132,136,140,144,148,152,156,160],"y":[-1.5007171630859375,-3.8390321731567383,-1.7105305194854736,-0.78237348794937134,-5.1166353225708008,3.4575815200805664,-0.30833381414413452,-6.4656891822814941,-2.1144137382507324,-2.6622889041900635,5.239593505859375,0.21878740191459656,0.94194710254669189,15.019224166870117,1.9626642465591431,-8.4808206558227539,2.8549644947052002,-3.7491915225982666,-0.454510897397995,-0.37278404831886292,-1.703700065612793,3.3597667217254639,7.3210873603820801,-5.2964425086975098,-12.75224494934082,-1.5450857877731323,1.0252953767776489,4.079045295715332,1.6421581506729126,5.8632392883300781,7.0218462944030762,11.786898612976074,-4.7621951103210449,-6.6522388458251953,8.9680986404418945,9.9583740234375,0.9228365421295166,0.01596684567630291,-7.1980690956115723,-4.7588062286376953,-4.904200553894043,-3.7027590274810791,-2.4121150970458984,-5.0299415588378906,-6.1399564743041992,1.2289742231369019,4.9076108932495117,5.8998608589172363,11.938809394836426,4.7980351448059082],"type":"scatter","mode":"lines","line":{"color":"#FF0000"},"name":"1","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[-36,-32,-28,-24,-20,-16,-12,-8,-4,0,4,8,12,16,20,24,28,32,36,40,44,48,52,56,60,64,68,72,76,80,84,88,92,96,100,104,108,112,116,120,124,128,132,136,140,144,148,152,156,160],"y":[9.6015596389770508,-1.3141337633132935,3.8061022758483887,4.3720779418945312,2.1418492794036865,5.1841778755187988,3.6653463840484619,11.401646614074707,6.4589672088623047,4.9035239219665527,8.3516445159912109,1.5535448789596558,-3.2307462692260742,0.82105475664138794,5.4740281105041504,5.1506137847900391,8.2047491073608398,11.624226570129395,7.8856840133666992,1.9454036951065063,1.1495842933654785,-2.6083817481994629,-0.99280828237533569,10.68275260925293,4.7740554809570312,4.4491558074951172,12.25205135345459,0.43309891223907471,-2.9669384956359863,0.52442342042922974,-1.5391336679458618,-0.037193305790424347,3.4692888259887695,3.8108692169189453,-2.1886353492736816,8.132380485534668,5.502955436706543,0.33676621317863464,18.576946258544922,7.4920053482055664,-2.4792940616607666,5.9642477035522461,-0.11780884116888046,1.5082348585128784,2.878281831741333,-3.874563455581665,15.133983612060547,1.7532316446304321,-6.0541396141052246,9.9627962112426758],"type":"scatter","mode":"lines","line":{"color":"#FF6D00"},"name":"2","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[-36,-32,-28,-24,-20,-16,-12,-8,-4,0,4,8,12,16,20,24,28,32,36,40,44,48,52,56,60,64,68,72,76,80,84,88,92,96,100,104,108,112,116,120,124,128,132,136,140,144,148,152,156,160],"y":[2.099940299987793,2.0985758304595947,-3.0234472751617432,1.6926807165145874,4.4447298049926758,0.49132123589515686,0.30906915664672852,3.9153871536254883,2.8700032234191895,1.6172536611557007,-2.0758190155029297,0.83221757411956787,7.8314146995544434,2.2121539115905762,-4.7596321105957031,3.6942110061645508,4.4773635864257812,-3.3881678581237793,0.27332144975662231,0.3806648850440979,2.1552515029907227,5.5333657264709473,2.8168106079101562,1.9873452186584473,-3.4855804443359375,-2.3699736595153809,-1.1716086864471436,0.36223712563514709,4.3143787384033203,4.586632251739502,3.6584153175354004,8.1202535629272461,5.5345182418823242,5.6126761436462402,7.1950740814208984,4.6055068969726562,-1.2796962261199951,0.51288002729415894,1.01884925365448,4.7999649047851562,4.6724176406860352,-0.84229892492294312,2.456878662109375,7.1160717010498047,1.9342383146286011,2.5723483562469482,2.397503137588501,-1.1950588226318359,1.2462261915206909,-0.7666316032409668],"type":"scatter","mode":"lines","line":{"color":"#FFDB00"},"name":"3","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[-36,-32,-28,-24,-20,-16,-12,-8,-4,0,4,8,12,16,20,24,28,32,36,40,44,48,52,56,60,64,68,72,76,80,84,88,92,96,100,104,108,112,116,120,124,128,132,136,140,144,148,152,156,160],"y":[2.6177432537078857,6.5651726722717285,4.6752133369445801,1.3108828067779541,-0.48569574952125549,-0.45700210332870483,4.304743766784668,6.6862645149230957,6.7970585823059082,2.6293377876281738,8.9308090209960938,10.372890472412109,-0.30779087543487549,-0.34896498918533325,-3.8716063499450684,-4.3824558258056641,1.4695069789886475,2.1950657367706299,3.9213371276855469,3.2821228504180908,3.5073184967041016,2.96636962890625,4.023228645324707,8.1909551620483398,9.1556997299194336,2.484217643737793,-0.7379639744758606,3.233661413192749,12.46923828125,9.6488609313964844,4.7270092964172363,3.7773251533508301,1.2677181959152222,8.1500625610351562,2.6074788570404053,0.080959349870681763,-0.3547319769859314,-0.009930088184773922,6.016115665435791,6.678032398223877,0.96799570322036743,-0.8544885516166687,-0.4930880069732666,-2.1004757881164551,-4.7189183235168457,-0.6472209095954895,4.2983627319335938,1.5714136362075806,-4.2859334945678711,-2.8548791408538818],"type":"scatter","mode":"lines","line":{"color":"#B6FF00"},"name":"4","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[-36,-32,-28,-24,-20,-16,-12,-8,-4,0,4,8,12,16,20,24,28,32,36,40,44,48,52,56,60,64,68,72,76,80,84,88,92,96,100,104,108,112,116,120,124,128,132,136,140,144,148,152,156,160],"y":[-4.7451009750366211,-4.2772302627563477,0.90816879272460938,5.902705192565918,5.1905694007873535,1.2524999380111694,0.13999946415424347,3.1757907867431641,1.2100013494491577,-1.5666570663452148,0.73577052354812622,2.6764330863952637,-0.47288614511489868,-1.6277186870574951,-0.0078840479254722595,1.8081129789352417,-1.6434317827224731,-4.2763757705688477,-2.1512448787689209,0.11542306840419769,-1.3060474395751953,1.1541261672973633,1.8149060010910034,3.3309381008148193,5.6345643997192383,1.7641862630844116,0.092147424817085266,0.58410245180130005,0.70929414033889771,1.0520185232162476,-1.9580127000808716,2.1275358200073242,1.5093895196914673,-3.6402888298034668,-5.0277328491210938,2.8196554183959961,3.5165207386016846,-2.4928581714630127,-3.3948769569396973,-0.6687396764755249,2.5741090774536133,-3.5576968193054199,-1.4683549404144287,-6.3026947975158691,-5.0114603042602539,-3.8324062824249268,-4.7524995803833008,-0.63822603225708008,9.3506221771240234,10.560935020446777],"type":"scatter","mode":"lines","line":{"color":"#49FF00"},"name":"5","marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[-36,-32,-28,-24,-20,-16,-12,-8,-4,0,4,8,12,16,20,24,28,32,36,40,44,48,52,56,60,64,68,72,76,80,84,88,92,96,100,104,108,112,116,120,124,128,132,136,140,144,148,152,156,160],"y":[-5.6276741027832031,-8.2466611862182617,-3.5649893283843994,-2.5207729339599609,-4.1167440414428711,-6.1831083297729492,-7.7999968528747559,-6.0480132102966309,-4.9822916984558105,-1.6721788644790649,0.20071987807750702,-6.6976685523986816,-7.7604503631591797,-7.273188591003418,-2.7257256507873535,-0.74476820230484009,-1.978050708770752,-1.8462104797363281,2.0398578643798828,2.8711659908294678,0.40267297625541687,-8.8082513809204102,-7.3433022499084473,-5.6089601516723633,-4.6884875297546387,-3.0180351734161377,-3.4371895790100098,-4.5837287902832031,-5.9390134811401367,-7.4295320510864258,-6.3577089309692383,-3.1974127292633057,-5.0913267135620117,-3.3886914253234863,-1.4779365062713623,-6.3724856376647949,-5.9736251831054688,-5.394679069519043,-5.4894180297851562,-1.1764962673187256,-3.2481698989868164,-3.0088858604431152,-2.2777643203735352,-1.9058750867843628,-2.397080659866333,-3.6483190059661865,0.29591381549835205,-1.14113450050354,-4.8062653541564941,-4.9489259719848633],"type":"scatter","mode":"lines","line":{"color":"#00FF24"},"name":"6","marker":{"color":"rgba(140,86,75,1)","line":{"color":"rgba(140,86,75,1)"}},"error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[-36,-32,-28,-24,-20,-16,-12,-8,-4,0,4,8,12,16,20,24,28,32,36,40,44,48,52,56,60,64,68,72,76,80,84,88,92,96,100,104,108,112,116,120,124,128,132,136,140,144,148,152,156,160],"y":[12.358329772949219,14.247807502746582,9.6314630508422852,16.974443435668945,20.07763671875,15.027661323547363,11.91938304901123,13.109491348266602,11.200965881347656,12.102944374084473,14.672438621520996,14.462520599365234,11.744317054748535,13.258547782897949,19.182239532470703,14.698263168334961,9.7050142288208008,9.438873291015625,14.056033134460449,14.907628059387207,10.391449928283691,13.070441246032715,17.767635345458984,15.302678108215332,22.003395080566406,21.556816101074219,15.132006645202637,18.044942855834961,11.875287055969238,10.532282829284668,11.582805633544922,11.211518287658691,13.084927558898926,15.556822776794434,14.146517753601074,12.301810264587402,11.573009490966797,14.311779975891113,12.36475658416748,10.493794441223145,10.707361221313477,10.651506423950195,11.002792358398438,13.251413345336914,11.764274597167969,13.602810859680176,13.251866340637207,7.380152702331543,13.91456127166748,13.944087982177734],"type":"scatter","mode":"lines","line":{"color":"#00FF92"},"name":"7","marker":{"color":"rgba(227,119,194,1)","line":{"color":"rgba(227,119,194,1)"}},"error_y":{"color":"rgba(227,119,194,1)"},"error_x":{"color":"rgba(227,119,194,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[-36,-32,-28,-24,-20,-16,-12,-8,-4,0,4,8,12,16,20,24,28,32,36,40,44,48,52,56,60,64,68,72,76,80,84,88,92,96,100,104,108,112,116,120,124,128,132,136,140,144,148,152,156,160],"y":[-2.798715353012085,-1.9492015838623047,-2.3699660301208496,-7.0672922134399414,-5.4622926712036133,-1.7053225040435791,2.261763334274292,2.6846582889556885,2.5001332759857178,1.1959306001663208,2.4931268692016602,-2.5658185482025146,-1.897327184677124,1.9756669998168945,1.6197667121887207,2.5265302658081055,2.4439311027526855,1.4483897686004639,6.2272777557373047,3.8141095638275146,-0.52537131309509277,-2.554274320602417,2.4977457523345947,1.8756211996078491,-3.5672228336334229,-3.0231459140777588,0.84124982357025146,5.0844707489013672,1.1904318332672119,-1.5007163286209106,0.069877669215202332,1.313379168510437,3.670090913772583,-3.2358968257904053,-2.6206495761871338,0.33061262965202332,4.6008462905883789,3.4458088874816895,1.3557971715927124,-0.71102708578109741,1.6747541427612305,1.5952399969100952,2.6812727451324463,6.1708354949951172,6.6338739395141602,4.5814895629882812,-2.9362998008728027,-0.5296897292137146,0.38813072443008423,1.9953632354736328],"type":"scatter","mode":"lines","line":{"color":"#00FFFF"},"name":"8","marker":{"color":"rgba(127,127,127,1)","line":{"color":"rgba(127,127,127,1)"}},"error_y":{"color":"rgba(127,127,127,1)"},"error_x":{"color":"rgba(127,127,127,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[-36,-32,-28,-24,-20,-16,-12,-8,-4,0,4,8,12,16,20,24,28,32,36,40,44,48,52,56,60,64,68,72,76,80,84,88,92,96,100,104,108,112,116,120,124,128,132,136,140,144,148,152,156,160],"y":[-0.55555105209350586,-0.096407659351825714,-2.0140070915222168,-2.6878736019134521,-0.56026840209960938,-2.1632490158081055,-0.50021857023239136,1.0939702987670898,-0.41176965832710266,-2.7262489795684814,-1.0052834749221802,0.78226912021636963,-1.1243621110916138,-2.953904390335083,-0.19422295689582825,-1.1890795230865479,-3.5899462699890137,-3.3907029628753662,-4.052088737487793,-5.5973525047302246,-9.2438020706176758,-3.5814456939697266,-2.6600983142852783,-2.44696044921875,-3.1421761512756348,-1.9972414970397949,0.55630403757095337,-0.42714035511016846,0.32583534717559814,1.3338794708251953,-1.3178849220275879,-2.8543386459350586,-1.1468319892883301,-0.27956625819206238,0.57232946157455444,-0.013076954521238804,-2.09645676612854,-2.6679203510284424,-4.500664234161377,-3.8336482048034668,-0.32004249095916748,-3.9639601707458496,-3.7727878093719482,-2.1115932464599609,-2.6661458015441895,-3.1399075984954834,-4.789405345916748,-1.9325956106185913,-4.0257010459899902,-0.6399916410446167],"type":"scatter","mode":"lines","line":{"color":"#0092FF"},"name":"9","marker":{"color":"rgba(188,189,34,1)","line":{"color":"rgba(188,189,34,1)"}},"error_y":{"color":"rgba(188,189,34,1)"},"error_x":{"color":"rgba(188,189,34,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[-36,-32,-28,-24,-20,-16,-12,-8,-4,0,4,8,12,16,20,24,28,32,36,40,44,48,52,56,60,64,68,72,76,80,84,88,92,96,100,104,108,112,116,120,124,128,132,136,140,144,148,152,156,160],"y":[-1.3256748914718628,-4.102013111114502,-1.232941746711731,1.0336520671844482,1.4136065244674683,-0.85457754135131836,-3.1614499092102051,0.73198127746582031,-5.2534971237182617,-7.3759551048278809,-2.4230918884277344,-2.259624719619751,-0.35897490382194519,3.0568342208862305,3.6959798336029053,-3.6467785835266113,-4.7731161117553711,0.19074982404708862,-1.2216815948486328,2.4738242626190186,-0.13753731548786163,-5.0437288284301758,-3.0033960342407227,-5.5151405334472656,-2.2119431495666504,-1.8679513931274414,-1.1658527851104736,0.54508793354034424,-3.7911369800567627,-1.6674072742462158,-1.162513256072998,-0.63873386383056641,2.6012558937072754,2.4109411239624023,-2.3020188808441162,-3.3428976535797119,-5.2246685028076172,-4.1085395812988281,-5.7959375381469727,-6.8805332183837891,-0.55460184812545776,-0.94962549209594727,-5.4897046089172363,-2.5570454597473145,1.0041104555130005,-1.522769570350647,-0.50578600168228149,0.54742604494094849,-0.53145325183868408,-3.7463827133178711],"type":"scatter","mode":"lines","line":{"color":"#0024FF"},"name":"10","marker":{"color":"rgba(23,190,207,1)","line":{"color":"rgba(23,190,207,1)"}},"error_y":{"color":"rgba(23,190,207,1)"},"error_x":{"color":"rgba(23,190,207,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[-36,-32,-28,-24,-20,-16,-12,-8,-4,0,4,8,12,16,20,24,28,32,36,40,44,48,52,56,60,64,68,72,76,80,84,88,92,96,100,104,108,112,116,120,124,128,132,136,140,144,148,152,156,160],"y":[-3.3037610054016113,-0.6394084095954895,3.0021851062774658,1.6760556697845459,-2.7293357849121094,-3.8091049194335938,-9.9975461959838867,-9.4043197631835938,-5.8673644065856934,-6.0759463310241699,-4.3935108184814453,0.35700201988220215,-0.15886232256889343,-3.2243735790252686,-6.2548346519470215,-4.2525467872619629,-1.9218916893005371,-1.2218326330184937,-3.0419871807098389,-3.684011697769165,-5.5903849601745605,-6.8434915542602539,-2.1434133052825928,-4.6025981903076172,-1.426789402961731,2.3575592041015625,3.689824104309082,1.0645489692687988,-2.5356345176696777,2.1523110866546631,4.1424679756164551,1.5181772708892822,-6.0870656967163086,-7.5864810943603516,-6.52642822265625,-9.3820266723632812,-8.7075185775756836,-2.7619407176971436,-1.6477483510971069,-3.833881139755249,-4.0235624313354492,0.31434115767478943,0.17047254741191864,2.2583057880401611,3.3424949645996094,-1.0238975286483765,-3.4283480644226074,-1.8398807048797607,-2.6524989604949951,-4.5417819023132324],"type":"scatter","mode":"lines","line":{"color":"#4900FF"},"name":"11","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[-36,-32,-28,-24,-20,-16,-12,-8,-4,0,4,8,12,16,20,24,28,32,36,40,44,48,52,56,60,64,68,72,76,80,84,88,92,96,100,104,108,112,116,120,124,128,132,136,140,144,148,152,156,160],"y":[-0.3606610894203186,-0.67927205562591553,-0.76999813318252563,-2.0242793560028076,-0.14417843520641327,-0.29244226217269897,-3.2505755424499512,-1.7753942012786865,1.1974493265151978,-0.13458919525146484,-5.9056239128112793,-6.9551863670349121,-7.2865543365478516,-5.6496186256408691,-3.8189034461975098,-5.6671404838562012,-3.2613153457641602,-2.00638747215271,1.9479389190673828,-1.9277119636535645,-3.3144857883453369,2.8765580654144287,2.0067205429077148,0.64490711688995361,-1.9237273931503296,-1.0877150297164917,-3.3264775276184082,-4.9865379333496094,-2.9172768592834473,-2.9113714694976807,-1.3435395956039429,1.2789429426193237,6.3952479362487793,5.4403014183044434,-0.99920034408569336,-0.8137703537940979,-4.1275839805603027,-5.9438080787658691,-5.6861629486083984,-3.0098598003387451,-1.1678082942962646,1.560762882232666,4.2445716857910156,3.3244919776916504,3.1315157413482666,5.5308475494384766,0.86875098943710327,-1.676719069480896,0.16259737312793732,-1.0807123184204102],"type":"scatter","mode":"lines","line":{"color":"#B600FF"},"name":"12","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[-36,-32,-28,-24,-20,-16,-12,-8,-4,0,4,8,12,16,20,24,28,32,36,40,44,48,52,56,60,64,68,72,76,80,84,88,92,96,100,104,108,112,116,120,124,128,132,136,140,144,148,152,156,160],"y":[-4.9444422721862793,-5.9574685096740723,-6.5879178047180176,-5.4320707321166992,-0.74808263778686523,-2.5278677940368652,-4.0680036544799805,-3.0890069007873535,-2.4629538059234619,2.1612284183502197,3.9424417018890381,3.7551195621490479,0.78454405069351196,-4.5891475677490234,-1.2527177333831787,0.35364833474159241,-2.2084259986877441,-2.8934605121612549,-2.7080674171447754,-3.9421491622924805,-4.942133903503418,-1.1183029413223267,-2.4326705932617188,-4.4480056762695312,-2.8996024131774902,-1.2202719449996948,-0.60487079620361328,-9.3990249633789062,-7.6804327964782715,-6.0855531692504883,-5.216855525970459,-1.9667582511901855,-1.5485039949417114,0.81059998273849487,-0.73026478290557861,-3.4094176292419434,-4.9110732078552246,-3.5280969142913818,-1.5672296285629272,-3.586435079574585,-0.95971667766571045,-0.93643391132354736,-0.016845960170030594,-0.1608264297246933,-5.8614177703857422,-5.6625237464904785,-5.905698299407959,-4.945589542388916,-2.7430038452148438,-2.8363800048828125],"type":"scatter","mode":"lines","line":{"color":"#FF00DB"},"name":"13","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[-36,-32,-28,-24,-20,-16,-12,-8,-4,0,4,8,12,16,20,24,28,32,36,40,44,48,52,56,60,64,68,72,76,80,84,88,92,96,100,104,108,112,116,120,124,128,132,136,140,144,148,152,156,160],"y":[102.43974304199219,101.2540283203125,103.22922515869141,109.41776275634766,108.36965942382812,103.88427734375,107.38697052001953,110.66517639160156,112.45401763916016,110.42935180664062,111.29965209960938,110.04114532470703,112.40159606933594,116.69001770019531,113.93140411376953,111.75457763671875,106.60502624511719,105.42090606689453,110.33756256103516,111.54541778564453,112.42721557617188,112.27970886230469,117.67740631103516,121.55725860595703,115.28553009033203,111.11392974853516,112.26280212402344,118.10604858398438,117.87856292724609,115.69547271728516,116.71920776367188,116.40088653564453,113.97608184814453,118.18453979492188,120.12683868408203,118.85855102539062,119.72238922119141,117.20394897460938,119.36458587646484,120.22838592529297,122.52146911621094,123.40882110595703,120.08171081542969,119.62357330322266,118.75247192382812,121.37683868408203,123.91744995117188,121.80594635009766,122.68184661865234,122.94452667236328],"type":"scatter","mode":"lines","line":{"color":"#FF006D"},"name":"14","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[-36,-32,-28,-24,-20,-16,-12,-8,-4,0,4,8,12,16,20,24,28,32,36,40,44,48,52,56,60,64,68,72,76,80,84,88,92,96,100,104,108,112,116,120,124,128,132,136,140,144,148,152,156,160],"y":[7.4253584359373361,6.647482543651547,7.4270399851458411,8.7046855900968829,8.7339155791061263,7.9503460547753741,7.2072250811117033,9.0487102440425335,8.8283075754131595,8.0589790088789801,10.004490544753414,9.0409737037760873,7.9361331760883331,9.0976130792072833,8.7843254001012863,7.9730262224163324,8.3131698455129346,7.6818487175873349,9.5042451513665061,8.9865536274654527,7.3764307083828111,7.9058899964605063,9.8107036990778784,9.6895963294165472,8.6253907510212482,9.1140317405973157,9.6719798243471562,9.4386294462851108,8.898196667432785,9.4138957304613928,9.2161415251238008,10.631462897041015,9.4908996735300342,9.6566892670733591,9.4102479262011389,9.5538696566197494,8.0830859499318262,7.7799555679916272,8.815496001924787,8.6594825940472742,8.9614793317658563,8.977055036595889,8.899230659274119,9.5060338644044737,8.760448745318822,8.9672643670013965,10.196671741349357,8.9327955160822192,9.6131284417850633,10.199289926460811],"type":"scatter","mode":"lines","line":{"color":"black"},"name":"Average","marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}
# 2) Plot sensor level waveforms with confidence bands for subject 1 and electrodes "E65" and "E182"
# a) preparing data
sendata <- epochdata |>
pick_data(subject_rg = 1, sensor_rg = c("E65", "E182")) |>
compute_mean(amplitude = "signal", domain = "time", level = "epoch")
# b) plot the waveforms without the average
interactive_waveforms(sendata, amplitude = "average", t0 = 10,
level = "sensor", avg = FALSE, CI = TRUE)

{"x":{"visdat":{"296937781d6f":["function () ","plotlyVisDat"],"296936c24d86":["function () ","data"],"296918a31ffc":["function () ","data"],"296929908a5e":["function () ","data"],"29692ca492ab":["function () ","data"]},"cur_data":"29692ca492ab","attrs":{"296936c24d86":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"ymin":{},"ymax":{},"type":"scatter","mode":"lines","hoveron":"points","fill":"toself","fillcolor":"#FF000066","line":{"color":"transparent"},"showlegend":false,"name":"E65 CI","inherit":true},"296918a31ffc":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines","line":{"color":"#FF0000"},"name":"E65","inherit":true},"296929908a5e":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"ymin":{},"ymax":{},"type":"scatter","mode":"lines","hoveron":"points","fill":"toself","fillcolor":"#00FFFF66","line":{"color":"transparent"},"showlegend":false,"name":"E182 CI","inherit":true},"29692ca492ab":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines","line":{"color":"#00FFFF"},"name":"E182","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"Time (ms)"},"yaxis":{"domain":[0,1],"automargin":true,"title":"$\\mu V$"},"showlegend":false,"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"fillcolor":"#FF000066","x":[-36,-32,-28,-24,-20,-16,-12,-8,-4,0,4,8,12,16,20,24,28,32,36,40,44,48,52,56,60,64,68,72,76,80,84,88,92,96,100,104,108,112,116,120,124,128,132,136,140,144,148,152,156,160,160,160,156,152,148,144,140,136,132,128,124,120,116,112,108,104,100,96,92,88,84,80,76,72,68,64,60,56,52,48,44,40,36,32,28,24,20,16,12,8,4,0,-4,-8,-12,-16,-20,-24,-28,-32,-36],"type":"scatter","mode":"lines","hoveron":"points","fill":"toself","line":{"color":"transparent"},"showlegend":false,"name":"E65 CI","y":[-8.6522934440852026,-9.4014281145825844,-8.6688815050008525,-8.3630665378877289,-8.223986957315061,-8.2553822161965762,-9.7266724125601254,-8.2438142286786285,-8.6281729479990936,-9.1754186865525238,-7.1431347751689085,-8.0656548120312284,-9.6660122099863734,-9.1648937078960184,-9.0611005610110578,-9.5849830235698512,-8.2177923728608739,-8.7984403010697463,-7.4967311665572058,-8.2918898841919972,-10.283397610898438,-9.7383652202356963,-8.4399888590070749,-9.2803950901555421,-9.7102061890832392,-8.2216021672262833,-7.6602938686687967,-8.9714834712887832,-9.5273812685933024,-8.5026712643152376,-8.8654274800297923,-7.1606715382212229,-8.1225413861691251,-8.7344805945360111,-9.2776377590733983,-8.9469956667027617,-10.731132239932437,-10.633156419520581,-10.052039121138217,-10.126853876799879,-10.049492599590105,-10.179241221682094,-9.7214885741320156,-9.0391583679641574,-9.7604560623949652,-9.9397998495342907,-9.0562918900951477,-9.9148043914878485,-9.5308337499957414,-8.8622455016337405,-8.8622455016337405,29.260825354555362,28.757090633565866,27.780395423652287,29.449635372793864,27.874328583537086,27.281353553032609,28.051226096773107,27.519949892680252,28.133351294873872,27.972451263121819,27.44581906489443,27.683031124987792,26.193067555503838,26.897304139796091,28.054734979942261,28.098133611475674,28.047859128682731,27.104340733229193,28.423597332303252,27.297710530277392,27.330462725238021,27.323774603458872,27.848742363859003,27.004253517363111,26.449665648420915,26.960987691125737,28.659587748988635,28.061396257162833,25.550145213156707,25.036259027664059,26.264997139122904,26.50522146929022,24.162137736244418,24.844132063886743,25.531035468402518,26.629751361213629,27.360119866310583,25.53827856216304,26.147602219583405,27.152115864675736,25.293376704310482,26.284788098825413,26.341234716763694,24.14112257478353,24.156074325747323,25.691818115527312,25.772437718081495,23.522961475292533,22.696393201885677,23.503010315959877],"marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[-36,-32,-28,-24,-20,-16,-12,-8,-4,0,4,8,12,16,20,24,28,32,36,40,44,48,52,56,60,64,68,72,76,80,84,88,92,96,100,104,108,112,116,120,124,128,132,136,140,144,148,152,156,160],"y":[7.4253584359373361,6.647482543651547,7.4270399851458411,8.7046855900968829,8.7339155791061263,7.9503460547753741,7.2072250811117033,9.0487102440425335,8.8283075754131595,8.0589790088789801,10.004490544753414,9.0409737037760873,7.9361331760883331,9.0976130792072833,8.7843254001012863,7.9730262224163324,8.3131698455129346,7.6818487175873349,9.5042451513665061,8.9865536274654527,7.3764307083828111,7.9058899964605063,9.8107036990778784,9.6895963294165472,8.6253907510212482,9.1140317405973157,9.6719798243471562,9.4386294462851108,8.898196667432785,9.4138957304613928,9.2161415251238008,10.631462897041015,9.4908996735300342,9.6566892670733591,9.4102479262011389,9.5538696566197494,8.0830859499318262,7.7799555679916272,8.815496001924787,8.6594825940472742,8.9614793317658563,8.977055036595889,8.899230659274119,9.5060338644044737,8.760448745318822,8.9672643670013965,10.196671741349357,8.9327955160822192,9.6131284417850633,10.199289926460811],"type":"scatter","mode":"lines","line":{"color":"#FF0000"},"name":"E65","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"#00FFFF66","x":[-36,-32,-28,-24,-20,-16,-12,-8,-4,0,4,8,12,16,20,24,28,32,36,40,44,48,52,56,60,64,68,72,76,80,84,88,92,96,100,104,108,112,116,120,124,128,132,136,140,144,148,152,156,160,160,160,156,152,148,144,140,136,132,128,124,120,116,112,108,104,100,96,92,88,84,80,76,72,68,64,60,56,52,48,44,40,36,32,28,24,20,16,12,8,4,0,-4,-8,-12,-16,-20,-24,-28,-32,-36],"type":"scatter","mode":"lines","hoveron":"points","fill":"toself","line":{"color":"transparent"},"showlegend":false,"name":"E182 CI","y":[-12.172240344208813,-12.941525836549287,-12.829482031879817,-13.620781763441498,-13.68638209968239,-12.731820066342486,-12.181219984468333,-12.600915703798707,-13.619087317458522,-12.392127817228117,-11.949846155001453,-13.3416457694942,-13.994921322873193,-13.812138810327806,-13.764888574299462,-14.602326410968413,-14.695784871065495,-14.95910281466163,-14.726722495355281,-13.687885862449859,-12.964166697955781,-13.222496179090788,-14.782568550179462,-14.070474171021536,-14.764926338778903,-15.116063787287718,-14.048032616353238,-15.803372559623497,-15.900118621764298,-14.507466961445559,-14.52648081043448,-14.275339483190065,-12.312247359171201,-11.363223802406226,-11.634010249839436,-13.115369908501631,-12.755781746444791,-12.56770192866542,-12.751177173314501,-12.125202139135284,-14.149111805210856,-14.088512332425134,-14.10272246043124,-14.77329012361394,-13.615427218562688,-14.192919223317652,-16.194353141875638,-14.953858697353132,-14.412744392987955,-15.931748720381385,-15.931748720381385,30.123437959930172,31.618040130288556,31.413724326493949,30.379825717557189,31.628438322553187,31.803937371473125,31.249955944540368,31.832392159078331,31.719896200492528,32.282851148922163,33.602473210637427,33.038323213685985,32.909006807768804,31.989791706312815,31.599050872017866,32.763821349436824,32.24460158986853,32.056375401204939,31.603788323740076,31.052287233178959,30.270490831777458,29.122024440771625,29.027674146881566,30.67748882989563,30.707911539109507,30.538355804924283,30.209780128747603,29.950107414451445,31.214924803295013,31.076685742917029,30.495116699028635,29.912792681574324,30.356898815414763,29.857215919663101,28.350861033969718,29.38291396233592,29.6980989464689,28.89809846075897,28.618732010398872,29.591273279186673,29.699597010652617,28.135401023584052,28.78787095140526,28.43213422179727,28.087588312652585,28.348857310962124,27.878729693709374,28.537783678248662,28.268415283352788,28.254336993276556],"marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[-36,-32,-28,-24,-20,-16,-12,-8,-4,0,4,8,12,16,20,24,28,32,36,40,44,48,52,56,60,64,68,72,76,80,84,88,92,96,100,104,108,112,116,120,124,128,132,136,140,144,148,152,156,160],"y":[8.0410483245338717,7.6634447234017511,7.8541508231844217,7.1289739651339392,7.331237605639866,7.6778841231550485,8.1254571186644693,8.0934776238032757,7.2581568530627658,8.6537345967122494,8.8207135620926103,7.6385431204523355,7.4515885689428876,7.9429800680705478,7.8090126940182278,6.8742673115006516,7.580715524298804,7.6988980003765652,7.5930350931095223,8.4036154182893892,9.0562595224806248,8.9962143121021132,7.5837694321359903,8.0696529788630347,7.8867147330726892,7.7959238759108951,8.3147281067711969,6.6121507936290334,6.6109529095036645,7.8815119351659506,8.2629032113722385,8.6642244202750067,9.87206402101687,10.440688893731151,10.564905549798693,9.2418404817581177,9.6170049799340109,10.170652439551693,10.143573020185743,10.738635535751071,9.0668696718556543,8.8156919340336959,8.8648348493235449,8.2383329104632139,9.0942550764552177,8.7177595496177673,7.0927362878407747,8.2299328145704091,8.6026478686502994,7.0958446197743923],"type":"scatter","mode":"lines","line":{"color":"#00FFFF"},"name":"E182","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}
```
