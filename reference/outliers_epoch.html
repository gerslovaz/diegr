<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Select outlier epochs — outliers_epoch • diegr</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Select outlier epochs — outliers_epoch"><meta name="description" content="Function identifies epochs with outlier values in a numeric EEG amplitude variable in chosen time points.
Outliers are detected separately at each time point within the groups present in the data. The function then summarizes how many times each epoch was marked as an outlier
across all time points.
Epochs are marked as outliers based on one of the following criteria: interquartile range criterion, percentile approach or Hampel filter method."><meta property="og:description" content="Function identifies epochs with outlier values in a numeric EEG amplitude variable in chosen time points.
Outliers are detected separately at each time point within the groups present in the data. The function then summarizes how many times each epoch was marked as an outlier
across all time points.
Epochs are marked as outliers based on one of the following criteria: interquartile range criterion, percentile approach or Hampel filter method."><meta property="og:image" content="https://gerslovaz.github.io/diegr/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">diegr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/diegr.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Database-workflows-for-HD-EEG-data-in-R.html">Database workflows for HD-EEG data in R</a></li>
    <li><a class="dropdown-item" href="../articles/example-animations.html">Example animations of HD-EEG topographic maps</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Select outlier epochs</h1>

      <div class="d-none name"><code>outliers_epoch.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function identifies epochs with outlier values in a numeric EEG amplitude variable in chosen time points.
Outliers are detected separately at each time point within the groups present in the data. The function then summarizes how many times each epoch was marked as an outlier
across all time points.</p>
<p>Epochs are marked as outliers based on one of the following criteria: interquartile range criterion, percentile approach or Hampel filter method.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">outliers_epoch</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  amplitude <span class="op">=</span> <span class="st">"signal"</span>,</span>
<span>  time <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"iqr"</span>, <span class="st">"percentile"</span>, <span class="st">"hampel"</span><span class="op">)</span>,</span>
<span>  k_iqr <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>  k_mad <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  p <span class="op">=</span> <span class="fl">0.975</span>,</span>
<span>  print_tab <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame, tibble or a database table with input data, required columns: <code>time</code>, <code>epoch</code> and the column with EEG amplitude specified by <code>amplitude</code> parameter. Optional columns: <code>group</code>, <code>subject</code>, <code>sensor</code>, <code>condition</code>.</p></dd>


<dt id="arg-amplitude">amplitude<a class="anchor" aria-label="anchor" href="#arg-amplitude"></a></dt>
<dd><p>A character specifying the name of the column from input data with an EEG amplitude values. Default is <code>"signal"</code>.</p></dd>


<dt id="arg-time">time<a class="anchor" aria-label="anchor" href="#arg-time"></a></dt>
<dd><p>A vector with time range for outliers detection. If not defined, the outliers are searched for all time points in the dataset.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>A character denoting the method used for outlier detection. The options are: <code>"iqr"</code> for interquartile range (IQR) criterion (default value), <code>"percentile"</code> for percentile method and <code>"hampel"</code> for Hampel filter method. See details for further information about methods.</p></dd>


<dt id="arg-k-iqr">k_iqr<a class="anchor" aria-label="anchor" href="#arg-k-iqr"></a></dt>
<dd><p>A positive numeric value denoting the scaling factor used in the IQR criterion. Default value is <code>k_iqr = 1.5</code>.</p></dd>


<dt id="arg-k-mad">k_mad<a class="anchor" aria-label="anchor" href="#arg-k-mad"></a></dt>
<dd><p>A positive numeric value denoting the scaling factor used in the Hampel filter method. Default value is <code>k_mad = 3</code>.</p></dd>


<dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>A probability value from <code>[0,1]</code> interval determining percentile to the percentile method (according to <code>probs</code> argument in <code><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile()</a></code> function). The default value is set to 0.975 for the interval formed by the 2.5 and 97.5 percentiles.</p></dd>


<dt id="arg-print-tab">print_tab<a class="anchor" aria-label="anchor" href="#arg-print-tab"></a></dt>
<dd><p>Logical. Indicates, whether result table should be printed in console. Default is <code>TRUE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with following components:</p>
<dl><dt>epoch_table</dt>
<dd><p>A data frame with epoch ID and the number of time points in which the epoch was evaluated as outlier. (Only epochs with occurrence of outliers in at least one time point are included.)</p></dd>

<dt>outliers_data</dt>
<dd><p>A data frame with subset of data corresponding to the outliers found. (The full record for each flagged point from <code>epoch_table</code>.)</p></dd>

</dl><p>With the setting <code>print_tab = TRUE</code>, the <code>epoch_table</code> is also printed to the console.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The input data frame or database table must contain at least following columns:
<code>epoch</code> - a column with epoch numbers/labels,
<code>time</code> - a column with time point numbers,
signal (or other name specified in <code>amplitude</code> parameter) - a column with measured EEG signal values.</p>
<p>The outlier detection method is chosen through <code>method</code> argument. The possibilities are</p><ul><li><p><code>iqr</code>: The interquartile range criterion, values outside the interval <code>[lower quartile - k_iqr * IQR, upper quartile + k_iqr * IQR]</code> are considered as outliers. IQR denotes interquartile range and <code>k_iqr</code> the scaling factor.</p></li>
<li><p><code>percentile</code>: The percentile method, values outside the interval defined by the chosen percentiles are considered as outliers. Note: chosing small <code>p</code>leads to marking too many (or all) values.</p></li>
<li><p><code>hampel</code>: The Hampel filter method, values outside the interval <code>[median - k_mad * MAD, median + k_mad * MAD]</code> are considered as outliers. MAD denotes median absolute deviation and <code>k_mad</code> the scaling factor.
Each of the above methods operates independently per time point, not globally across time.</p></li>
</ul><p>Note: For large datasets, the calculation can be time-consuming. It is recommended to pre-filter or subset the data before using this function to reduce computation time.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># 1. Outlier epoch detection for subject 2, electrode E45 for the whole time range with IQR method</span></span></span>
<span class="r-in"><span><span class="va">epochdata</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span><span class="fu"><a href="pick_data.html">pick_data</a></span><span class="op">(</span>subject_rg <span class="op">=</span> <span class="fl">2</span>, sensor_rg <span class="op">=</span> <span class="st">"E45"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span><span class="fu">outliers_epoch</span><span class="op">(</span>amplitude <span class="op">=</span> <span class="st">"signal"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 8 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   subject sensor epoch count</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 2       E45    7         5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> 2       E45    8         6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> 2       E45    9         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> 2       E45    10        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> 2       E45    11        2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> 2       E45    13        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">7</span> 2       E45    14       50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">8</span> 2       E45    15       50</span>
<span class="r-in"><span><span class="co">## From the result table we see that epochs 14 and 15 were marked as outliers in 50 cases out of 50</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 2. Outlier epoch detection for both subjects, electrode E45 for the whole time range</span></span></span>
<span class="r-in"><span><span class="co"># using percentile method with 1 and 99 percentiles</span></span></span>
<span class="r-in"><span><span class="va">outdata</span> <span class="op">&lt;-</span> <span class="va">epochdata</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span><span class="fu"><a href="pick_data.html">pick_data</a></span><span class="op">(</span>sensor_rg <span class="op">=</span> <span class="st">"E45"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span><span class="fu">outliers_epoch</span><span class="op">(</span>amplitude <span class="op">=</span> <span class="st">"signal"</span>, method <span class="op">=</span> <span class="st">"percentile"</span>, p <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   subject sensor epoch count</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 1       E45    13       50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> 1       E45    14       50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> 2       E45    14       50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> 2       E45    15       50</span>
<span class="r-in"><span><span class="co"># see head of outliers data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">outdata</span><span class="op">$</span><span class="va">outliers_data</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    time signal epoch sensor subject</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1  -<span style="color: #BB0000;">22.6</span> 13    E45    1      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>     2  -<span style="color: #BB0000;">25.0</span> 13    E45    1      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>     3  -<span style="color: #BB0000;">24.0</span> 13    E45    1      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>     4  -<span style="color: #BB0000;">23.1</span> 13    E45    1      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>     5  -<span style="color: #BB0000;">21.1</span> 13    E45    1      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span>     6  -<span style="color: #BB0000;">19.3</span> 13    E45    1      </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zdeňka Geršlová.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

