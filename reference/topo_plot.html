<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot topographic map of EEG signal — topo_plot • diegr</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot topographic map of EEG signal — topo_plot"><meta name="description" content="Plot a topographic circle or polygon map of the EEG signal amplitude using topographic colour scale. The thin-plate spline interpolation model \(\text{IM:}\; \mathbb{R}^2 \rightarrow \mathbb{R}\) is used for signal interpolation between the sensor locations.
The output in the form of a ggplot object allows to easily edit the result image properties.
The function assumes that the input data have already been filtered to the desired subset (e.g., group, subject, time point)."><meta property="og:description" content="Plot a topographic circle or polygon map of the EEG signal amplitude using topographic colour scale. The thin-plate spline interpolation model \(\text{IM:}\; \mathbb{R}^2 \rightarrow \mathbb{R}\) is used for signal interpolation between the sensor locations.
The output in the form of a ggplot object allows to easily edit the result image properties.
The function assumes that the input data have already been filtered to the desired subset (e.g., group, subject, time point)."><meta property="og:image" content="https://gerslovaz.github.io/diegr/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">diegr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/diegr.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Database-workflows-for-HD-EEG-data-in-R.html">Database workflows for HD-EEG data in R</a></li>
    <li><a class="dropdown-item" href="../articles/example-animations.html">Example animations of HD-EEG topographic maps</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Plot topographic map of EEG signal</h1>

      <div class="d-none name"><code>topo_plot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Plot a topographic circle or polygon map of the EEG signal amplitude using topographic colour scale. The thin-plate spline interpolation model \(\text{IM:}\; \mathbb{R}^2 \rightarrow \mathbb{R}\) is used for signal interpolation between the sensor locations.
The output in the form of a ggplot object allows to easily edit the result image properties.</p>
<p>The function assumes that the input data have already been filtered to the desired subset (e.g., group, subject, time point).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">topo_plot</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">amplitude</span>,</span>
<span>  <span class="va">mesh</span>,</span>
<span>  coords <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  template <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  col_range <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  col_scale <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  contour <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  show_legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  label_sensors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame, tibble or a database table with input data to plot with at least two columns: <code>sensor</code> with sensor labels and the column with the EEG amplitude specified in the argument <code>amplitude</code>.</p></dd>


<dt id="arg-amplitude">amplitude<a class="anchor" aria-label="anchor" href="#arg-amplitude"></a></dt>
<dd><p>A character string naming the column with EEG amplitude values.</p></dd>


<dt id="arg-mesh">mesh<a class="anchor" aria-label="anchor" href="#arg-mesh"></a></dt>
<dd><p>A <code>"mesh"</code> object (or a named list with the same structure) containing at least <code>D2</code> element with x and y coordinates of a point mesh used for computing IM model. If not defined, the point mesh with default settings from <code><a href="point_mesh.html">point_mesh</a></code> function is used.</p></dd>


<dt id="arg-coords">coords<a class="anchor" aria-label="anchor" href="#arg-coords"></a></dt>
<dd><p>Sensor coordinates as a tibble or data frame with named <code>x</code>, <code>y</code> and <code>sensor</code> columns. The <code>sensor</code> labels must match the labels in sensor column in <code>data</code>. If not defined, the HCGSN256 template is used.</p></dd>


<dt id="arg-template">template<a class="anchor" aria-label="anchor" href="#arg-template"></a></dt>
<dd><p>The kind of sensor template montage used. Currently the only available option is <code>"HCGSN256"</code> denoting the 256-channel HydroCel Geodesic Sensor Net v.1.0, which is also a default setting.</p></dd>


<dt id="arg-col-range">col_range<a class="anchor" aria-label="anchor" href="#arg-col-range"></a></dt>
<dd><p>A vector with minimum and maximum value of the amplitude used in the colour palette for plotting. If not defined, the range of interpolated signal is used.</p></dd>


<dt id="arg-col-scale">col_scale<a class="anchor" aria-label="anchor" href="#arg-col-scale"></a></dt>
<dd><p>Optionally, a colour scale to be utilised for plotting. It should be a list with <code>colors</code> and <code>breaks</code> components (usually created via <code><a href="create_scale.html">create_scale</a></code>). If not defined, it is computed from <code>col_range</code>.</p></dd>


<dt id="arg-contour">contour<a class="anchor" aria-label="anchor" href="#arg-contour"></a></dt>
<dd><p>Logical. Indicates, whether contours should be plotted in the graph. Default value is <code>FALSE</code>.</p></dd>


<dt id="arg-show-legend">show_legend<a class="anchor" aria-label="anchor" href="#arg-show-legend"></a></dt>
<dd><p>Logical. Indicates, whether legend should be displayed beside the graph. Default value is <code>TRUE</code>.</p></dd>


<dt id="arg-label-sensors">label_sensors<a class="anchor" aria-label="anchor" href="#arg-label-sensors"></a></dt>
<dd><p>A logical value indicating whether the sensor labels should also be plotted. Default value is <code>FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>ggplot</code> object showing an interpolated topographic map of EEG amplitude.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For more details about required mesh structure see <code><a href="point_mesh.html">point_mesh</a></code> function. If the input <code>mesh</code> structure does not match this format, an error or incorrect function behavior may occur.</p>
<p>Be careful when choosing the argument <code>col_range</code>. If the amplitude in input data contains values outside the chosen range, this will cause "holes" in the resulting plot.
To compare results for different subjects or conditions, set the same values of <code>col_range</code> and <code>col_scale</code> arguments in all cases.
The default used scale is based on topographical colours with zero value always at the border of blue and green shades.</p>
<p>Notes:
When specifying the <code>coords</code> and <code>template</code> at the same time, the <code>template</code> parameter takes precedence and the <code>coords</code> parameter is ignored.</p>
<p>This function focuses on visualization and does not perform any data subsetting. Users are expected to filter the data beforehand using standard dplyr verbs or <code><a href="pick_data.html">pick_data</a></code> function.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="point_mesh.html">point_mesh</a></code>, animated version: <code><a href="animate_topo.html">animate_topo</a></code>, average topo map: <code><a href="plot_topo_mean.html">plot_topo_mean</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Plot average topographic map of signal for subject 2 from the time point 10</span></span></span>
<span class="r-in"><span><span class="co"># (the time of the stimulus) without the outliers (epoch 14 and 15)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># a) preparing data</span></span></span>
<span class="r-in"><span><span class="co"># a1) extract required data</span></span></span>
<span class="r-in"><span><span class="va">edata</span> <span class="op">&lt;-</span> <span class="fu"><a href="pick_data.html">pick_data</a></span><span class="op">(</span><span class="va">epochdata</span>, subject_rg <span class="op">=</span> <span class="fl">2</span>, epoch_rg <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">13</span>, time_rg <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># a2) baseline correction (needed for suitable topographic map)</span></span></span>
<span class="r-in"><span><span class="va">data_base</span> <span class="op">&lt;-</span> <span class="fu"><a href="baseline_correction.html">baseline_correction</a></span><span class="op">(</span><span class="va">edata</span>, baseline_range <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># a3) average computing</span></span></span>
<span class="r-in"><span><span class="va">data_mean</span> <span class="op">&lt;-</span> <span class="va">data_base</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">time</span> <span class="op">==</span> <span class="fl">10</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span><span class="fu"><a href="compute_mean.html">compute_mean</a></span><span class="op">(</span>amplitude <span class="op">=</span> <span class="st">"signal_base"</span>, type <span class="op">=</span> <span class="st">"jack"</span>, domain <span class="op">=</span> <span class="st">"space"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># b) plotting the topographic map with contours and legend</span></span></span>
<span class="r-in"><span><span class="co"># interval (-30,15) is selected in consideration of the signal progress</span></span></span>
<span class="r-in"><span><span class="fu">topo_plot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_mean</span>, amplitude <span class="op">=</span> <span class="st">"average"</span>, template <span class="op">=</span> <span class="st">"HCGSN256"</span>,</span></span>
<span class="r-in"><span>col_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">30</span>, <span class="fl">15</span><span class="op">)</span>, contour <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="topo_plot-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># c) plotting the same map without contours but with sensor labels</span></span></span>
<span class="r-in"><span><span class="fu">topo_plot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_mean</span>, amplitude <span class="op">=</span> <span class="st">"average"</span>, template <span class="op">=</span> <span class="st">"HCGSN256"</span>,</span></span>
<span class="r-in"><span> col_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">30</span>, <span class="fl">15</span><span class="op">)</span>, label_sensors <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="topo_plot-2.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zdeňka Geršlová.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

